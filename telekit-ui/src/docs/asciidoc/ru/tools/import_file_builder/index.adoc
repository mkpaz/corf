Это утилита, которая позволяет генерировать текстовые файла произвольного формата по заранее заданному шаблону. Это могут быть MML скрипты; CSV, JSON или XML файлы; фактически любой текстовый файл, который имеет повторяющуюся структуру.

Общий вид:

image::tools/import_file_builder_main.png[]

==== Элементы управления

* Template - выбранный шаблон и выпадающий список с опциями управления шаблоном:
** Preview - предварительный просмотр выбранного шаблона;
** New - создание нового шаблона;
** Edit - редактирование выбранного шаблона;
** Duplicate - создание нового шаблона, начальные данные будут скопированы из выбранного шаблона;
** Delete - удаление выбранного шаблона;
** Import - импорт нового шаблона из файла;
** Export - экспорт выбранного шаблона в файл;
* Parameters - таблица параметров для замены, которые остаются постоянными при генерации файла импорта. Добавление и удаление параметров выполняется через контекстное меню. Типы параметров:
** CONSTANT - постоянное значение;
** PASSWORD - случайная строка заданной длины сгенерированная из символов `[a-ZA-Z0-9]`;
** PASSWORD_BASE64 - то же самое, что и предыдущий пункт, но значение будет преобразовано в BASE64 строку после генерации;
** UUID - 16-байтный https://ru.wikipedia.org/wiki/UUID[уникальный идентификатор] (например, `718b5495-4511-4064-8923-560ec2127d23`).
+
* List fo replacement - список параметров для замены. Представляет собой CSV (список значений разделенных запятыми) таблицу. В качестве разделителя элементов строки поддерживается запятая или точка с запятой;
* Clipboard - дополнительные опции для вставки из буфера обмена в список параметров для замены:
** Paste from MS Excel - вставка данных из MS Excel;
** Paste columns on the right - вставка данных с правой стороны от уже имеющихся в списке данных (табличная вставка).
* Параметры сохранения файла:
** Show save dialog - отображать диалог сохранения файла при каждой генерации;
** Save into - выбрать заранее определенное место сохранения файла. Используется совместно с опцией _append if exists_ - если активирована, то сгенерированные данные дописываются в существующей файл, в другом случае - файл переписывается полностью.
* Generate - запуск генерации файла. Рядом указывается кодировка и формат разделителя строк специфичный для операционной системы (рекомендуется всегда выбирать UNIX формат).
* Open file after generation - открыть созданный текстовый файл для просмотра после генерации.

==== Использование

Для использования генератора необходимо создать шаблон описывающий структуру целевого текстового файла.

При создании шаблона поддерживаются следующие поля (* отмечены обязательные пункты):

* Name *** - уникальное имя шаблона;
* Header - заголовок (например, заголовок CSV);
* Footer - "подвал" (например, закрывающий XML тэг);
* Delimiter - разделитель элементов шаблона. Если шаблон может быть представлен в виде таблицы (например, CSV), то при указанном разделителе, превью также будет показано в табличном виде, что может быть удобно при большом количестве ячеек таблицы. На генерацию данный параметр никак не влияет;
* Pattern *** - текст шаблона;
* Description - описание - любая дополнительная / справочная информация к шаблону.

Допустим, необходимо сгенерировать скрипт, который состоит из набора команд, т.е. структура целевого файла имеет вид:

```
CREATE_SUBSCRIBER: phone="123", area_code="999";
CREATE_SUBSCRIBER: phone="456", area_code="999";
```

Из примера видно что каждая строка содержит одно изменяемое значение (`phone`) и одно неизменяемое (`area_code`), которое разумно вынести в параметры для переиспользования шаблона с другими значениями `area_code` в дальнейшем.

Таким образом соответствующий текст шаблона будет:

```
CREATE_SUBSCRIBER: phone="%(_csv0)", area_code="%(area_code)"
```

Правила замены при генерации:

* формат параметров для замены имеет вид: `%(имя_параметра)`, где `имя_параметра`:
** один из встроенных параметров:
*** `index0` - порядковый номер строки списка начиная с 0;
*** `index1` - порядковый номер строки списка начиная с 1;
** название параметра из таблицы *Parameters*;
** идентификатор параметра из списка *List for replacement*. В этом случае, имя параметра имеет фиксированный вид `_csvX`, где X - порядковый номер начиная с 0.

Возвращаясь к примеру, если список для замены имеет вид:

```
123,aaa
456,bbb
789,ccc
```

а в таблице параметров создан параметр `area_code` с типом CONSTANT, которому назначено значение `999`, то будет сгенерирован текстовый файл из 3-х строк, т.е. количество строк в файле равно количеству строк в списке для замены умноженном на количество строк к тексте шаблона.

```
CREATE_SUBSCRIBER: phone="123", area_code="999";
CREATE_SUBSCRIBER: phone="456", area_code="999";
CREATE_SUBSCRIBER: phone="789", area_code="999";
```

Как видно, параметр `_csv1` был проигнорирован, поскольку соответствующее ему выражение для замены `%(_csv1)` нигде в шаблоне не фигурирует. Таким образом, одну и ту же таблицу (список для замены) можно использовать многократно в нескольких шаблонах просто выбирая в каждом из них только нужные колонки.


